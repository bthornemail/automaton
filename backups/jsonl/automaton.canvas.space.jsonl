{"id": "canvas-space-self-ref", "type": "file", "x": 0, "y": 0, "width": 300, "height": 120, "color": "1", "file": "automaton.canvas.space.jsonl", "metadata": {"purpose": "Self-reference to canvas space", "regenerate": true, "selfReference": {"file": "automaton.canvas.space.jsonl", "line": 1, "pattern": "meta-circular"}}}
{"id": "canvas-space-kernel-constraint", "type": "shacl", "target": "kernel", "constraints": [{"sh:path": "selfReference", "sh:minCount": 1, "sh:hasValue": "automaton-kernel.jsonl"}, {"sh:path": "dimensionalLevel", "sh:datatype": "xsd:integer", "sh:minInclusive": 0, "sh:maxInclusive": 7}, {"sh:path": "currentState", "sh:nodeKind": "sh:Literal", "sh:minCount": 1}], "metadata": {"regenerate": {"function": "r5rs:load-shacl-shapes", "args": ["facts"]}, "description": "SHACL constraints for kernel validation"}}
{"id": "canvas-space-seed-constraint", "type": "shacl", "target": "seed", "constraints": [{"sh:path": "metadata.regenerate", "sh:minCount": 1}, {"sh:path": "selfReference.file", "sh:hasValue": "automaton-kernel.jsonl"}, {"sh:path": "selfReference.line", "sh:datatype": "xsd:integer", "sh:minInclusive": 1}], "metadata": {"regenerate": {"function": "r5rs:shacl-validate", "args": ["shapes", "triples"]}, "description": "SHACL constraints for seed validation"}}
{"id": "canvas-space-bipartite-input", "type": "interface", "partition": "left", "category": "input", "x": -400, "y": 200, "width": 280, "height": 160, "color": "2", "text": "# Input Interface\n\n**Bipartite Left Partition: Input**\n\n- **Data Input**: `r5rs:parse-jsonl-canvas(filename)`\n- **URI Input**: `r5rs:sparql-query(query-str, triples)`\n- **Stream Input**: `r5rs:read-line()`\n- **File Input**: `r5rs:read-all-chars()`\n\n**R5RS Functions**:\n- `r5rs:parse-jsonl-canvas`\n- `r5rs:read-line`\n- `r5rs:read-all-chars`\n- `r5rs:read-from-string`\n\n*Input partition for automaton.jsonl rendering*", "metadata": {"regenerate": {"function": "r5rs:parse-jsonl-canvas", "args": ["automaton.jsonl"]}, "interface": {"type": "input", "partition": "left", "data": true, "uri": true}}}
{"id": "canvas-space-bipartite-output", "type": "interface", "partition": "right", "category": "output", "x": 400, "y": 200, "width": 280, "height": 160, "color": "3", "text": "# Output Interface\n\n**Bipartite Right Partition: Output**\n\n- **Data Output**: `write-jsonl(filename, objects)`\n- **URI Output**: `r5rs:sparql-query(query-str, triples)`\n- **Stream Output**: `display(...)`\n- **Rendering Output**: Canvas visualization\n\n**R5RS Functions**:\n- `r5rs:jsonl-to-rdf`\n- `r5rs:rdf-query`\n- `r5rs:sparql-query`\n\n*Output partition for automaton.jsonl rendering*", "metadata": {"regenerate": {"function": "r5rs:jsonl-to-rdf", "args": ["facts"]}, "interface": {"type": "output", "partition": "right", "data": true, "uri": true}}}
{"id": "canvas-space-bipartite-data", "type": "interface", "partition": "left", "category": "data", "x": -400, "y": 400, "width": 280, "height": 160, "color": "4", "text": "# Data Interface\n\n**Bipartite Left Partition: Data**\n\n- **JSONL Data**: Parsed objects from `automaton.jsonl`\n- **Facts Data**: Datalog facts extracted from JSONL\n- **Triples Data**: RDF triples from facts\n- **Node Data**: Canvas nodes with x, y, text\n- **Edge Data**: Canvas edges with fromNode, toNode\n\n**R5RS Functions**:\n- `r5rs:extract-facts`\n- `r5rs:query-facts`\n- `r5rs:jsonl-to-rdf`\n\n*Data partition for automaton.jsonl rendering*", "metadata": {"regenerate": {"function": "r5rs:extract-facts", "args": ["parsed-objects"]}, "interface": {"type": "data", "partition": "left", "input": true, "output": true}}}
{"id": "canvas-space-bipartite-uri", "type": "interface", "partition": "right", "category": "uri", "x": 400, "y": 400, "width": 280, "height": 160, "color": "5", "text": "# URI Interface\n\n**Bipartite Right Partition: URI**\n\n- **RDF URI**: `canvas:`, `rdf:`, `rdfs:`, `owl:`, `sh:`\n- **SPARQL URI**: Query endpoints\n- **File URI**: `file://automaton.jsonl`\n- **HTTP URI**: `http://example.org/automaton-metadata`\n\n**R5RS Functions**:\n- `r5rs:rdf-query`\n- `r5rs:sparql-query`\n- `r5rs:rdfs-entail`\n\n*URI partition for automaton.jsonl rendering*", "metadata": {"regenerate": {"function": "r5rs:rdf-query", "args": ["triples", "?", "?", "?"]}, "interface": {"type": "uri", "partition": "right", "input": true, "output": true}}}
{"id": "canvas-space-kernel-validator", "type": "validator", "target": "kernel", "x": -200, "y": 600, "width": 260, "height": 180, "color": "6", "text": "# Kernel Validator\n\n**Validates automaton-kernel.jsonl**\n\n**Constraints**:\n- SHACL: `selfReference` must reference `automaton-kernel.jsonl`\n- RFC2119: Each dimension MUST implement exactly one system\n- ASP: Exactly one layer per node\n- Prolog: Church encoding validation\n- Datalog: Implementation completeness\n\n**R5RS Functions**:\n- `r5rs:load-shacl-shapes`\n- `r5rs:shacl-validate`\n- `r5rs:prolog-query`\n- `r5rs:datalog-query`\n\n**Validation Pattern**:\n```scheme\n(define (validate-kernel kernel-file)\n  (let ((facts (extract-facts (parse-jsonl-canvas kernel-file))))\n    (let ((shapes (load-shacl-shapes facts))\n          (triples (jsonl-to-rdf facts)))\n      (shacl-validate shapes triples))))\n```", "function": "r5rs:shacl-validate", "args": ["shapes", "triples"], "metadata": {"regenerate": {"function": "r5rs:shacl-validate", "args": ["shapes", "triples"]}, "target": "automaton-kernel.jsonl"}}
{"id": "canvas-space-seed-validator", "type": "validator", "target": "seed", "x": 200, "y": 600, "width": 260, "height": 180, "color": "7", "text": "# Seed Validator\n\n**Validates automaton-kernel.seed.jsonl**\n\n**Constraints**:\n- SHACL: `metadata.regenerate` must exist\n- SHACL: `selfReference.file` must be `automaton-kernel.jsonl`\n- SHACL: `selfReference.line` must be integer ≥ 1\n- Validation: All nodes must have regeneration metadata\n\n**R5RS Functions**:\n- `r5rs:load-shacl-shapes`\n- `r5rs:shacl-validate`\n- `r5rs:query-facts`\n\n**Validation Pattern**:\n```scheme\n(define (validate-seed seed-file)\n  (let ((facts (extract-facts (parse-jsonl-canvas seed-file))))\n    (let ((regenerate-nodes (query-facts facts '(node ?id ?type . ?rest))))\n      (andmap (lambda (n) (has-regenerate-metadata? n)) regenerate-nodes))))\n```", "function": "r5rs:shacl-validate", "args": ["shapes", "triples"], "metadata": {"regenerate": {"function": "r5rs:shacl-validate", "args": ["shapes", "triples"]}, "target": "automaton-kernel.seed.jsonl"}}
{"id": "canvas-space-renderer-automaton", "type": "renderer", "target": "automaton.jsonl", "x": 0, "y": 800, "width": 300, "height": 200, "color": "1", "text": "# Automaton.jsonl Renderer\n\n**Renders automaton.jsonl to Canvas**\n\n**Input**: `automaton.jsonl` (JSONL file)\n**Output**: Canvas visualization (nodes + edges)\n\n**Rendering Pipeline**:\n1. **Parse**: `r5rs:parse-jsonl-canvas(\"automaton.jsonl\")`\n2. **Extract**: `r5rs:extract-facts(parsed-objects)`\n3. **Transform**: `r5rs:jsonl-to-rdf(facts)` → RDF triples\n4. **Query**: `r5rs:sparql-query` for nodes/edges\n5. **Render**: Generate canvas visualization\n\n**Bipartite Structure**:\n- **Left (Data)**: Node/edge data from JSONL\n- **Right (URI)**: RDF triples and SPARQL queries\n\n**R5RS Functions**:\n- `r5rs:parse-jsonl-canvas`\n- `r5rs:extract-facts`\n- `r5rs:jsonl-to-rdf`\n- `r5rs:sparql-query`", "function": "r5rs:parse-jsonl-canvas", "args": ["automaton.jsonl"], "metadata": {"regenerate": {"function": "r5rs:parse-jsonl-canvas", "args": ["automaton.jsonl"]}, "interface": {"input": "automaton.jsonl", "output": "canvas-visualization", "data": true, "uri": true}}}
{"id": "canvas-space-bipartite-cons", "type": "edge", "fromNode": "canvas-space-bipartite-input", "toNode": "canvas-space-bipartite-output", "fromSide": "right", "toSide": "left", "label": "input→output", "metadata": {"regenerate": {"function": "r5rs:cons", "args": ["input", "output"]}, "bipartite": {"left": "input", "right": "output"}}}
{"id": "canvas-space-bipartite-data-uri", "type": "edge", "fromNode": "canvas-space-bipartite-data", "toNode": "canvas-space-bipartite-uri", "fromSide": "right", "toSide": "left", "label": "data→uri", "metadata": {"regenerate": {"function": "r5rs:cons", "args": ["data", "uri"]}, "bipartite": {"left": "data", "right": "uri"}}}
{"id": "canvas-space-input-to-data", "type": "edge", "fromNode": "canvas-space-bipartite-input", "toNode": "canvas-space-bipartite-data", "fromSide": "bottom", "toSide": "top", "label": "input→data", "metadata": {"regenerate": {"function": "r5rs:extract-facts", "args": ["input"]}}}
{"id": "canvas-space-output-to-uri", "type": "edge", "fromNode": "canvas-space-bipartite-output", "toNode": "canvas-space-bipartite-uri", "fromSide": "bottom", "toSide": "top", "label": "output→uri", "metadata": {"regenerate": {"function": "r5rs:jsonl-to-rdf", "args": ["output"]}}}
{"id": "canvas-space-render-pipeline", "type": "pipeline", "steps": ["parse-automaton", "extract-facts", "jsonl-to-rdf", "sparql-query", "render-canvas"], "x": 0, "y": 1050, "width": 400, "height": 200, "color": "2", "text": "# Rendering Pipeline\n\n**Pipeline for automaton.jsonl → Canvas**\n\n**Step 1: Parse**\n```scheme\n(define parsed (parse-jsonl-canvas \"automaton.jsonl\"))\n```\n\n**Step 2: Extract Facts**\n```scheme\n(define facts (extract-facts parsed))\n```\n\n**Step 3: Convert to RDF**\n```scheme\n(define triples (jsonl-to-rdf facts))\n```\n\n**Step 4: Query for Rendering**\n```scheme\n(define nodes (sparql-query \"SELECT ?id ?x ?y ?text WHERE { ?id rdf:type canvas:Node }\" triples))\n(define edges (sparql-query \"SELECT ?id ?from ?to WHERE { ?id rdf:type canvas:Edge }\" triples))\n```\n\n**Step 5: Render Canvas**\n```scheme\n(render-canvas nodes edges)\n```\n\n**R5RS Functions**:\n- `r5rs:parse-jsonl-canvas`\n- `r5rs:extract-facts`\n- `r5rs:jsonl-to-rdf`\n- `r5rs:sparql-query`", "function": "r5rs:invoke-from-jsonl", "args": ["r5rs:parse-jsonl-canvas", ["automaton.jsonl"], "context"], "metadata": {"regenerate": {"function": "r5rs:invoke-from-jsonl", "args": ["r5rs:parse-jsonl-canvas", ["automaton.jsonl"], "context"]}}}
{"id": "canvas-space-kernel-seed-constraint", "type": "constraint", "rule": "kernel-must-have-seed", "x": -600, "y": 600, "width": 240, "height": 180, "color": "8", "text": "# Kernel-Seed Constraint\n\n**Constraint**: Kernel MUST have corresponding seed\n\n**ASP Rule**:\n```prolog\n:- kernel(K), not seed(S), generates(S, K).\n```\n\n**Datalog Rule**:\n```prolog\nmissing_seed(K) :- kernel(K), not seed(S), generates(S, K).\n```\n\n**SHACL Constraint**:\n```json\n{\"sh:path\": \"canvas:generates\", \"sh:minCount\": 1}\n```\n\n**R5RS Functions**:\n- `r5rs:datalog-query`\n- `r5rs:prolog-query`\n- `r5rs:shacl-validate`", "function": "r5rs:datalog-query", "args": ["program", "(missing_seed ?k)"], "metadata": {"regenerate": {"function": "r5rs:datalog-query", "args": ["program", "(missing_seed ?k)"]}}}
{"id": "canvas-space-seed-kernel-constraint", "type": "constraint", "rule": "seed-must-generate-kernel", "x": 600, "y": 600, "width": 240, "height": 180, "color": "1", "text": "# Seed-Kernel Constraint\n\n**Constraint**: Seed MUST generate kernel\n\n**ASP Rule**:\n```prolog\n:- seed(S), not kernel(K), generates(S, K).\n```\n\n**Datalog Rule**:\n```prolog\nseed_without_kernel(S) :- seed(S), not kernel(K), generates(S, K).\n```\n\n**SHACL Constraint**:\n```json\n{\"sh:path\": \"canvas:generates\", \"sh:hasValue\": \"automaton-kernel.jsonl\"}\n```\n\n**R5RS Functions**:\n- `r5rs:datalog-query`\n- `r5rs:prolog-query`\n- `r5rs:shacl-validate`", "function": "r5rs:datalog-query", "args": ["program", "(seed_without_kernel ?s)"], "metadata": {"regenerate": {"function": "r5rs:datalog-query", "args": ["program", "(seed_without_kernel ?s)"]}}}
{"id": "canvas-space-extendable-interface", "type": "interface", "extendable": true, "x": 0, "y": 1300, "width": 350, "height": 220, "color": "3", "text": "# Extendable Bipartite Interface\n\n**Extensible Interface for Input/Output and Data/URI**\n\n**Left Partition (Input/Data)**:\n- **Input Extensions**:\n  - File input: `r5rs:parse-jsonl-canvas`\n  - Stream input: `r5rs:read-line`\n  - URI input: `r5rs:sparql-query`\n  - Custom input: Extend via `metadata.regenerate`\n\n- **Data Extensions**:\n  - JSONL data: `r5rs:extract-facts`\n  - RDF data: `r5rs:jsonl-to-rdf`\n  - Custom data: Extend via bipartite structure\n\n**Right Partition (Output/URI)**:\n- **Output Extensions**:\n  - File output: `write-jsonl`\n  - Stream output: `display`\n  - Canvas output: Rendering functions\n  - Custom output: Extend via `metadata.regenerate`\n\n- **URI Extensions**:\n  - RDF URI: `canvas:`, `rdf:`, `rdfs:`, `owl:`\n  - SPARQL URI: Query endpoints\n  - Custom URI: Extend via namespace\n\n**Extension Pattern**:\n```scheme\n(define (extend-interface partition category function)\n  (cons (list partition category function) interface-registry))\n```", "metadata": {"regenerate": {"function": "r5rs:cons", "args": ["left-partition", "right-partition"]}, "extendable": {"left": ["input", "data"], "right": ["output", "uri"]}}}
{"id": "canvas-space-uri-namespace", "type": "namespace", "prefix": "canvas", "iri": "http://example.org/canvas-space/", "x": -300, "y": 1300, "width": 250, "height": 180, "color": "4", "text": "# URI Namespace\n\n**Canvas Space URI Namespace**\n\n**Prefixes**:\n- `canvas:` → `http://example.org/canvas-space/`\n- `canvas:kernel` → Kernel files\n- `canvas:seed` → Seed files\n- `canvas:interface` → Bipartite interfaces\n- `canvas:renderer` → Rendering functions\n\n**RDF Triples**:\n```turtle\ncanvas:automaton-canvas-space rdf:type canvas:CanvasSpace .\ncanvas:automaton-canvas-space canvas:validates canvas:kernel .\ncanvas:automaton-canvas-space canvas:validates canvas:seed .\ncanvas:automaton-canvas-space canvas:renders canvas:automaton .\n```\n\n**R5RS Functions**:\n- `r5rs:rdf-query`\n- `r5rs:sparql-query`", "metadata": {"regenerate": {"function": "r5rs:rdf-query", "args": ["triples", "canvas:", "?", "?"]}}}
{"id": "canvas-space-render-automaton-jsonl", "type": "render-operation", "target": "automaton.jsonl", "x": 300, "y": 1300, "width": 250, "height": 180, "color": "5", "text": "# Render automaton.jsonl\n\n**Rendering Operation**\n\n**Input**: `automaton.jsonl`\n**Output**: Canvas visualization\n\n**Operation Steps**:\n1. Load `automaton.jsonl`\n2. Parse JSONL lines\n3. Extract nodes (type: text, automaton, operation)\n4. Extract edges (type: vertical, horizontal, transition)\n5. Extract operations (type: opencode-*) \n6. Render to canvas space\n\n**Bipartite Processing**:\n- **Left (Data)**: Process node/edge data\n- **Right (URI)**: Process RDF triples and queries\n\n**R5RS Functions**:\n- `r5rs:parse-jsonl-canvas(\"automaton.jsonl\")`\n- `r5rs:extract-facts(parsed)`\n- `r5rs:query-facts(facts, '(node ?id text ?x ?y ?text))'`\n- `r5rs:query-facts(facts, '(operation ?id ?tool ?params))'`", "function": "r5rs:parse-jsonl-canvas", "args": ["automaton.jsonl"], "metadata": {"regenerate": {"function": "r5rs:parse-jsonl-canvas", "args": ["automaton.jsonl"]}, "rendering": {"input": "automaton.jsonl", "output": "canvas", "bipartite": {"left": "data", "right": "uri"}}}}
{"id": "canvas-space-self-regeneration", "type": "regeneration", "source": "automaton.canvas.space.jsonl", "target": "automaton.canvas.space.jsonl", "x": 0, "y": 1550, "width": 400, "height": 200, "color": "6", "text": "# Self-Regeneration\n\n**Canvas Space Can Regenerate Itself**\n\n**Regeneration Pattern**:\n```scheme\n(define (regenerate-canvas-space)\n  (let ((seed (parse-jsonl-canvas \"automaton.canvas.space.jsonl\")))\n    (let ((facts (extract-facts seed)))\n      (let ((regenerate-nodes (query-facts facts '(node ?id ?type . ?rest))))\n        (for-each (lambda (node)\n                    (let ((func (get-regenerate-function node))\n                          (args (get-regenerate-args node)))\n                      (invoke-from-jsonl func args context)))\n                  regenerate-nodes)))))\n```\n\n**Self-Reference**:\n- Line 1: Self-reference to `automaton.canvas.space.jsonl`\n- Each node includes `metadata.regenerate`\n- Each validator includes regeneration function\n- Each interface includes extension pattern\n\n**R5RS Functions**:\n- `r5rs:parse-jsonl-canvas`\n- `r5rs:extract-facts`\n- `r5rs:query-facts`\n- `r5rs:invoke-from-jsonl`", "metadata": {"regenerate": {"function": "r5rs:invoke-from-jsonl", "args": ["r5rs:parse-jsonl-canvas", ["automaton.canvas.space.jsonl"], "context"]}, "selfReference": {"file": "automaton.canvas.space.jsonl", "line": 1}}}
{"id": "canvas-space-constraint-enforcement", "type": "enforcement", "x": -500, "y": 1550, "width": 280, "height": 200, "color": "7", "text": "# Constraint Enforcement\n\n**Enforces Constraints for Kernels and Seeds**\n\n**Kernel Constraints**:\n- SHACL: `selfReference` validation\n- RFC2119: Dimension implementation\n- ASP: Layer uniqueness\n- Prolog: Church encoding\n- Datalog: Completeness\n\n**Seed Constraints**:\n- SHACL: `metadata.regenerate` required\n- SHACL: `selfReference.file` validation\n- SHACL: `selfReference.line` validation\n- Validation: Regeneration metadata completeness\n\n**Enforcement Functions**:\n```scheme\n(define (enforce-kernel-constraints kernel-file)\n  (let ((facts (extract-facts (parse-jsonl-canvas kernel-file))))\n    (let ((shapes (load-shacl-shapes facts))\n          (triples (jsonl-to-rdf facts)))\n      (shacl-validate shapes triples))))\n\n(define (enforce-seed-constraints seed-file)\n  (let ((facts (extract-facts (parse-jsonl-canvas seed-file))))\n    (let ((shapes (load-shacl-shapes facts))\n          (triples (jsonl-to-rdf facts)))\n      (shacl-validate shapes triples))))\n```\n\n**R5RS Functions**:\n- `r5rs:load-shacl-shapes`\n- `r5rs:shacl-validate`\n- `r5rs:datalog-query`\n- `r5rs:prolog-query`", "function": "r5rs:shacl-validate", "args": ["shapes", "triples"], "metadata": {"regenerate": {"function": "r5rs:shacl-validate", "args": ["shapes", "triples"]}, "enforcement": {"kernel": true, "seed": true}}}
{"id": "canvas-space-bipartite-structure", "type": "structure", "x": 500, "y": 1550, "width": 280, "height": 200, "color": "1", "text": "# Bipartite Structure\n\n**Extendable Bipartite Interface**\n\n**Structure**:\n```\nLeft Partition (Input/Data)    Right Partition (Output/URI)\n├── Input Interface             ├── Output Interface\n│   - File input                │   - File output\n│   - Stream input              │   - Stream output\n│   - URI input                 │   - Canvas output\n│   - Custom input              │   - Custom output\n│                               │\n└── Data Interface             └── URI Interface\n    - JSONL data                    - RDF URI\n    - Facts data                    - SPARQL URI\n    - Triples data                  - File URI\n    - Custom data                   - Custom URI\n```\n\n**Church Encoding**:\n- Pair: `λx.λy.λf.fxy`\n- Left: `λp.p(λx.λy.x)`\n- Right: `λp.p(λx.λy.y)`\n\n**Extension Pattern**:\n```scheme\n(define (extend-bipartite left right)\n  (cons left right))\n```\n\n**R5RS Functions**:\n- `r5rs:cons`\n- `r5rs:car`\n- `r5rs:cdr`", "metadata": {"regenerate": {"function": "r5rs:cons", "args": ["left-partition", "right-partition"]}, "bipartite": {"left": ["input", "data"], "right": ["output", "uri"]}}}
{"id": "v:canvas-space-self-ref→canvas-space-kernel-constraint", "fromNode": "canvas-space-self-ref", "toNode": "canvas-space-kernel-constraint", "fromSide": "bottom", "toSide": "top", "label": "self-reference→constraint", "metadata": {"regenerate": {"function": "r5rs:church-succ", "args": ["self-ref"]}}}
{"id": "v:canvas-space-kernel-constraint→canvas-space-bipartite-input", "fromNode": "canvas-space-kernel-constraint", "toNode": "canvas-space-bipartite-input", "fromSide": "bottom", "toSide": "top", "label": "constraint→interface", "metadata": {"regenerate": {"function": "r5rs:church-succ", "args": ["kernel-constraint"]}}}
{"id": "h:canvas-space-bipartite-input→canvas-space-bipartite-output", "fromNode": "canvas-space-bipartite-input", "toNode": "canvas-space-bipartite-output", "fromSide": "right", "toSide": "left", "label": "input→output", "metadata": {"regenerate": {"function": "r5rs:cons", "args": ["input", "output"]}, "bipartite": {"left": "input", "right": "output"}}}
{"id": "h:canvas-space-bipartite-data→canvas-space-bipartite-uri", "fromNode": "canvas-space-bipartite-data", "toNode": "canvas-space-bipartite-uri", "fromSide": "right", "toSide": "left", "label": "data→uri", "metadata": {"regenerate": {"function": "r5rs:cons", "args": ["data", "uri"]}, "bipartite": {"left": "data", "right": "uri"}}}
{"id": "h:canvas-space-kernel-validator→canvas-space-seed-validator", "fromNode": "canvas-space-kernel-validator", "toNode": "canvas-space-seed-validator", "fromSide": "right", "toSide": "left", "label": "kernel→seed", "metadata": {"regenerate": {"function": "r5rs:cons", "args": ["kernel-validator", "seed-validator"]}}}
{"id": "canvas-space-render-automaton-nodes", "type": "render-operation", "operation": "render-nodes", "target": "automaton.jsonl", "x": -200, "y": 1800, "width": 250, "height": 160, "color": "2", "text": "# Render Nodes\n\n**Render Nodes from automaton.jsonl**\n\n**Query**:\n```sparql\nSELECT ?id ?type ?x ?y ?text ?color\nWHERE {\n  ?id rdf:type canvas:Node .\n  ?id canvas:x ?x .\n  ?id canvas:y ?y .\n  ?id canvas:text ?text .\n  OPTIONAL { ?id canvas:color ?color }\n}\n```\n\n**R5RS Functions**:\n- `r5rs:sparql-query(query-str, triples)`\n- `r5rs:rdf-query(triples, id, ?, ?)`\n\n**Output**: List of node objects for canvas rendering", "function": "r5rs:sparql-query", "args": ["SELECT ?id ?type ?x ?y ?text WHERE { ?id rdf:type canvas:Node }", "triples"], "metadata": {"regenerate": {"function": "r5rs:sparql-query", "args": ["query-str", "triples"]}, "rendering": {"target": "nodes"}}}
{"id": "canvas-space-render-automaton-edges", "type": "render-operation", "operation": "render-edges", "target": "automaton.jsonl", "x": 200, "y": 1800, "width": 250, "height": 160, "color": "3", "text": "# Render Edges\n\n**Render Edges from automaton.jsonl**\n\n**Query**:\n```sparql\nSELECT ?id ?fromNode ?toNode ?label\nWHERE {\n  ?id rdf:type canvas:Edge .\n  ?id canvas:fromNode ?fromNode .\n  ?id canvas:toNode ?toNode .\n  OPTIONAL { ?id canvas:label ?label }\n}\n```\n\n**R5RS Functions**:\n- `r5rs:sparql-query(query-str, triples)`\n- `r5rs:rdf-query(triples, id, ?, ?)`\n\n**Output**: List of edge objects for canvas rendering", "function": "r5rs:sparql-query", "args": ["SELECT ?id ?fromNode ?toNode ?label WHERE { ?id rdf:type canvas:Edge }", "triples"], "metadata": {"regenerate": {"function": "r5rs:sparql-query", "args": ["query-str", "triples"]}, "rendering": {"target": "edges"}}}
{"id": "canvas-space-render-automaton-operations", "type": "render-operation", "operation": "render-operations", "target": "automaton.jsonl", "x": 0, "y": 2000, "width": 300, "height": 160, "color": "4", "text": "# Render Operations\n\n**Render OpenCode Operations from automaton.jsonl**\n\n**Query**:\n```sparql\nSELECT ?id ?tool ?params ?dimension ?timestamp\nWHERE {\n  ?id rdf:type canvas:Operation .\n  ?id canvas:tool ?tool .\n  ?id canvas:params ?params .\n  ?id canvas:dimension ?dimension .\n  OPTIONAL { ?id canvas:timestamp ?timestamp }\n}\n```\n\n**R5RS Functions**:\n- `r5rs:sparql-query(query-str, triples)`\n- `r5rs:query-facts(facts, '(operation ?id ?tool ?params))'`\n\n**Output**: List of operation objects for canvas rendering", "function": "r5rs:sparql-query", "args": ["SELECT ?id ?tool ?params WHERE { ?id rdf:type canvas:Operation }", "triples"], "metadata": {"regenerate": {"function": "r5rs:sparql-query", "args": ["query-str", "triples"]}, "rendering": {"target": "operations"}}}
{"id": "canvas-space-complete-render", "type": "render-complete", "target": "automaton.jsonl", "x": 0, "y": 2200, "width": 400, "height": 200, "color": "5", "text": "# Complete Rendering\n\n**Complete Rendering of automaton.jsonl**\n\n**Pipeline**:\n```scheme\n(define (render-automaton-jsonl filename)\n  ;; Step 1: Parse\n  (let ((parsed (parse-jsonl-canvas filename)))\n    ;; Step 2: Extract facts\n    (let ((facts (extract-facts parsed)))\n      ;; Step 3: Convert to RDF\n      (let ((triples (jsonl-to-rdf facts)))\n        ;; Step 4: Query nodes\n        (let ((nodes (sparql-query \n                      \"SELECT ?id ?type ?x ?y ?text WHERE { ?id rdf:type canvas:Node }\"\n                      triples)))\n          ;; Step 5: Query edges\n          (let ((edges (sparql-query\n                        \"SELECT ?id ?fromNode ?toNode WHERE { ?id rdf:type canvas:Edge }\"\n                        triples)))\n            ;; Step 6: Query operations\n            (let ((operations (sparql-query\n                               \"SELECT ?id ?tool ?params WHERE { ?id rdf:type canvas:Operation }\"\n                               triples)))\n              ;; Step 7: Render canvas\n              (render-canvas nodes edges operations)))))))))\n```\n\n**Bipartite Processing**:\n- **Left (Data)**: Process nodes, edges, operations\n- **Right (URI)**: Process RDF triples and SPARQL queries\n\n**R5RS Functions**:\n- `r5rs:parse-jsonl-canvas`\n- `r5rs:extract-facts`\n- `r5rs:jsonl-to-rdf`\n- `r5rs:sparql-query`", "function": "r5rs:invoke-from-jsonl", "args": ["r5rs:parse-jsonl-canvas", ["automaton.jsonl"], "context"], "metadata": {"regenerate": {"function": "r5rs:invoke-from-jsonl", "args": ["r5rs:parse-jsonl-canvas", ["automaton.jsonl"], "context"]}, "rendering": {"complete": true, "bipartite": {"left": "data", "right": "uri"}}}
{"id": "canvas-space-metadata", "type": "graph", "iri": "http://example.org/canvas-space/", "triples": [["canvas:automaton-canvas-space", "rdf:type", "canvas:CanvasSpace"], ["canvas:automaton-canvas-space", "canvas:validates", "canvas:kernel"], ["canvas:automaton-canvas-space", "canvas:validates", "canvas:seed"], ["canvas:automaton-canvas-space", "canvas:renders", "canvas:automaton"], ["canvas:automaton-canvas-space", "canvas:bipartite", "true"], ["canvas:automaton-canvas-space", "canvas:extendable", "true"], ["canvas:automaton-canvas-space", "canvas:selfReference", "true"]], "metadata": {"regenerate": {"function": "r5rs:jsonl-to-rdf", "args": ["facts"]}}}
{"id": "canvas-space-final-reflection", "type": "reflection", "statement": "This canvas space provides a meta-layer above the kernel and seed that: (1) Enforces constraints for kernels and seeds via SHACL validation, (2) Provides an extendable bipartite interface separating input/output and data/URI, (3) Enables rendering of automaton.jsonl through R5RS functions, (4) Maintains self-referential structure for regeneration, (5) Supports extension through metadata.regenerate patterns. The bipartite structure follows Church pair encoding: left partition (input/data) and right partition (output/URI), enabling clean separation of concerns for canvas rendering.", "metadata": {"regenerate": {"function": "r5rs:invoke-from-jsonl", "args": ["r5rs:church-zero", [], "context"]}}}
